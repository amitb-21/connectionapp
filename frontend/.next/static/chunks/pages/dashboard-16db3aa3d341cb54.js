(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{8078:e=>{e.exports={scrollComponent:"styles_scrollComponent__R_GAt",createPostcontainer:"styles_createPostcontainer__VV_P_",userProfile:"styles_userProfile__RVyoN",Fab:"styles_Fab__cS8NK",uploadButton:"styles_uploadButton__6SuyM",previewContainer:"styles_previewContainer__emu1o",previewImage:"styles_previewImage__X_pPT",loader:"styles_loader__3_mBG",spin:"styles_spin__HmSy_",postContainers:"styles_postContainers__RubT8",singleCard:"styles_singleCard__eWtSO",singleCard__profileContainer:"styles_singleCard__profileContainer__0bJC0",userInfo:"styles_userInfo__T_d52",userName:"styles_userName__hYP2o",userHandle:"styles_userHandle__q42_W",deleteButton:"styles_deleteButton__6xpB2",singleCard__content:"styles_singleCard__content__z7K57",postMedia:"styles_postMedia__I6yK0",sortToggleContainer:"styles_sortToggleContainer__JLe9o",sortToggleButton:"styles_sortToggleButton__b0zzw",fadeIn:"styles_fadeIn___k7yL",optionsContainer:"styles_optionsContainer__zwpkC",singleOption__optionsConatiner:"styles_singleOption__optionsConatiner__23jIl",likesModalOverlay:"styles_likesModalOverlay__BCmKQ",likesModal:"styles_likesModal__dCMd4",likesModalHeader:"styles_likesModalHeader__X3yiR",backButton:"styles_backButton__uhThT",likesModalContent:"styles_likesModalContent__6wPiJ",likeUserItem:"styles_likeUserItem__5ggEM",likeUserAvatar:"styles_likeUserAvatar__JQuwQ",likeUserInfo:"styles_likeUserInfo__TRl4Z",likeUserName:"styles_likeUserName__Wzevo",likeUserHandle:"styles_likeUserHandle__G8huv",noLikesMessage:"styles_noLikesMessage__6Vph8",likedByUsers:"styles_likedByUsers__kco5H",likedAvatars:"styles_likedAvatars__i5trX",likedAvatar:"styles_likedAvatar__Dbkiq",likedByText:"styles_likedByText__DDKKK",likedByPreview:"styles_likedByPreview__qSa_q"}},8507:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(8725)}])},8725:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var l=t(7876),i=t(4232),o=t(9099),n=t(5459),a=t(1777),r=t(2431);t(4916);var d=t(1280),c=t(1071),_=t(3969),p=t(8078),u=t.n(p),m=t(1436);function h(){var e,s,t,p,h;(0,o.useRouter)();let v=(0,a.wA)(),g=(0,a.d4)(e=>e.auth),k=(0,a.d4)(e=>e.posts),[x,y]=(0,i.useState)(""),[C,j]=(0,i.useState)(null),[w,f]=(0,i.useState)(null),[N,B]=(0,i.useState)(!1),[M,L]=(0,i.useState)(!1),[b,I]=(0,i.useState)("latest"),[P,U]=(0,i.useState)(!1),[A,E]=(0,i.useState)(null),[T,S]=(0,i.useState)({}),[O,H]=(0,i.useState)({isOpen:!1,postId:null}),[z,W]=(0,i.useState)(1);(0,i.useEffect)(()=>{g.isTokenThere&&(v((0,n.zX)({page:1,limit:10})),v((0,r.Zt)())),g.all_profiles_fetched||v((0,r.CF)())},[g.isTokenThere,v]),(0,i.useEffect)(()=>{k.posts&&k.posts.length>0&&k.posts.forEach(e=>{e.likesCount>0&&v((0,n.Fh)({post_id:e._id}))})},[k.posts,v]),(0,i.useEffect)(()=>{k.posts&&k.posts.length>0&&k.posts.forEach(e=>{v((0,n.wG)({post_id:e._id,page:1}))})},[k.posts,v]),(0,i.useEffect)(()=>{let e=()=>{let e=document.getElementById("scrollComponent");if(e){var s;let{scrollTop:t,scrollHeight:l,clientHeight:i}=e;t+i>=l-100&&!N&&(null===(s=k.pagination)||void 0===s?void 0:s.hasMore)&&Y()}},s=document.getElementById("scrollComponent");return s&&s.addEventListener("scroll",e),()=>{s&&s.removeEventListener("scroll",e)}},[z,N,null===(e=k.pagination)||void 0===e?void 0:e.hasMore]);let F=async()=>{(x||C)&&(B(!0),await v((0,n.pD)({file:C,body:x})),y(""),j(null),f(null),B(!1))},R=async e=>{!M&&confirm("Are you sure you want to delete this post?")&&(L(!0),await v((0,n.ys)({post_id:e})),v((0,n.zX)()),L(!1))},D=()=>k.posts?[...k.posts].sort((e,s)=>{let t=new Date(e.createdAt),l=new Date(s.createdAt);return"latest"===b?l-t:t-l}):[],X=e=>e?"@"+e.toLowerCase().replace(/\s+/g,"_"):"",K=async e=>{await v((0,n.GB)({post_id:e}))},Z=e=>!!(k.likedByUser&&k.likedByUser[e]),G=e=>{E(e),v((0,n.Fh)({post_id:e})),U(!0)},V=e=>{H({isOpen:!0,postId:e})},q=()=>{H({isOpen:!1,postId:null})},[J,Q]=(0,i.useState)(!0),Y=()=>{if(k.pagination&&k.pagination.hasMore){let e=z+1;v((0,n.zX)({page:e,limit:10})),W(e)}};return g.user?(0,l.jsx)(d.A,{children:(0,l.jsx)(c.A,{children:(0,l.jsxs)("div",{className:u().scrollComponent,children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:u().createPostcontainer,children:[(0,l.jsx)("img",{src:"".concat(m.C,"/uploads/").concat((null===(s=g.user)||void 0===s?void 0:s.profilePicture)||"default.png"),alt:"Profile",className:u().userProfile,onError:e=>{e.target.src="/images/default-profile.png"}}),(0,l.jsx)("textarea",{onChange:e=>y(e.target.value),value:x,placeholder:"What's on your mind?"}),(0,l.jsx)("label",{htmlFor:"fileUpload",children:(0,l.jsx)("div",{className:u().Fab,title:"Add photo",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.8,stroke:"currentColor",children:[" ",(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})," "]})})}),(0,l.jsx)("input",{onChange:e=>{let s=e.target.files[0];if(j(s),s){let e=new FileReader;e.onloadend=()=>{f(e.result)},e.readAsDataURL(s)}else f(null)},type:"file",hidden:!0,id:"fileUpload",accept:"image/*"}),(x.length>0||w)&&(0,l.jsx)("button",{onClick:F,className:u().uploadButton,disabled:N,children:N?(0,l.jsx)("div",{className:u().loader}):"Share"})]}),w&&(0,l.jsx)("div",{className:u().previewContainer,children:(0,l.jsx)("img",{src:w,alt:"Preview",className:u().previewImage})}),(0,l.jsx)("div",{className:u().sortToggleContainer,children:(0,l.jsxs)("button",{onClick:()=>{I("latest"===b?"earliest":"latest")},className:u().sortToggleButton,title:"Currently showing ".concat("latest"===b?"newest":"oldest"," posts first"),children:["latest"===b?"Most Recent":"Oldest First",(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"16",height:"16",style:{marginLeft:"8px"},children:[" ",(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"latest"===b?"M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12":"M3 4h13M3 8h9m-9 4h9m5-4v12m0 0l-4-4m4 4l4-4"})," "]})]})}),(0,l.jsx)("div",{className:u().postContainers,children:D().length>0?D().map(e=>{var s,t,i,o,n,a,r,d,c,p;return(0,l.jsxs)("div",{className:u().singleCard,children:[(0,l.jsxs)("div",{className:u().singleCard__profileContainer,children:[(0,l.jsx)("img",{src:"".concat(m.C,"/uploads/").concat((null===(s=e.userId)||void 0===s?void 0:s.profilePicture)||"default.png"),alt:"Profile",className:u().userProfile,onError:e=>{e.target.src="/images/default-profile.png"}}),(0,l.jsxs)("div",{className:u().userInfo,children:[(0,l.jsx)("p",{className:u().userName,children:null===(t=e.userId)||void 0===t?void 0:t.name}),(0,l.jsx)("p",{className:u().userHandle,children:X(null===(i=e.userId)||void 0===i?void 0:i.name)})]}),(null===(o=e.userId)||void 0===o?void 0:o._id)===(null===(n=g.user)||void 0===n?void 0:n._id)&&(0,l.jsx)("button",{className:u().deleteButton,onClick:()=>R(e._id),disabled:M,title:"Delete post",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"20",height:"20",children:[" ",(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})," "]})})]}),(0,l.jsxs)("div",{className:u().singleCard__content,children:[(0,l.jsx)("p",{children:e.body}),e.media&&(0,l.jsx)("img",{src:"".concat(m.C,"/uploads/").concat(e.media),alt:"Post media",className:u().postMedia,onError:e=>{e.target.style.display="none"}})]}),(0,l.jsxs)("div",{className:u().optionsContainer,children:[(0,l.jsxs)("div",{className:u().singleOption__optionsConatiner,onClick:()=>K(e._id),children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:Z(e._id)?"currentColor":"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"})}),(0,l.jsx)("p",{children:e.likesCount||(null===(a=e.likes)||void 0===a?void 0:a.length)||0})]}),(0,l.jsx)("div",{className:u().singleOption__optionsConatiner,children:(0,l.jsxs)("button",{onClick:()=>V(e._id),className:u().commentButton,style:{display:"flex",alignItems:"center",gap:"5px",background:"none",border:"none",cursor:"pointer"},children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"24",height:"24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 20.25c4.97 0 9-3.694 9-8.25s-4.03-8.25-9-8.25S3 7.444 3 12c0 2.104.859 4.023 2.273 5.48.432.447.74 1.04.586 1.641a4.483 4.483 0 01-.923 1.785A5.969 5.969 0 006 21c1.282 0 2.47-.402 3.445-1.087.81.22 1.668.337 2.555.337z"})}),(0,l.jsx)("p",{children:k.commentCountsByPostId[e._id]||0})]})}),(0,l.jsx)("div",{className:u().singleOption__optionsConatiner,children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"size-6",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"})})})]}),(e.likesCount>0||(null===(r=e.likes)||void 0===r?void 0:r.length)>0)&&(0,l.jsxs)("div",{className:u().likedByUsers,children:[(0,l.jsx)("div",{className:u().likedAvatars,children:null===(c=k.currentPostLikes[e._id])||void 0===c?void 0:null===(d=c.previewLikes)||void 0===d?void 0:d.slice(0,3).map((e,s)=>(0,l.jsx)("img",{src:"".concat(m.C,"/uploads/").concat(e.profilePicture||"default.png"),alt:e.name,className:u().likedAvatar,style:{marginLeft:s>0?"-8px":"0"},onError:e=>{e.target.src="/images/default-profile.png"}},e._id))}),(0,l.jsx)("p",{className:u().likedByText,onClick:()=>G(e._id),children:1===e.likesCount?"Liked by 1 person":"Liked by ".concat(e.likesCount||(null===(p=e.likes)||void 0===p?void 0:p.length)," people")})]}),(0,l.jsx)(_.A,{isOpen:O.isOpen,onClose:q,postId:O.postId})]},e._id)}):(0,l.jsx)("div",{className:u().singleCard,style:{textAlign:"center",padding:"2rem"},children:(0,l.jsx)("p",{style:{color:"#65676b"},children:"No posts to display. Be the first to share something!"})})}),(null===(t=k.pagination)||void 0===t?void 0:t.hasMore)&&(0,l.jsx)("div",{className:u().singleCard,style:{textAlign:"center",padding:"1rem"},children:(0,l.jsx)("div",{className:u().loader})})]}),P&&(0,l.jsx)("div",{className:u().likesModalOverlay,children:(0,l.jsxs)("div",{className:u().likesModal,children:[(0,l.jsxs)("div",{className:u().likesModalHeader,children:[(0,l.jsx)("button",{className:u().backButton,onClick:()=>{U(!1),E(null)},children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",width:"24",height:"24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18"})})}),(0,l.jsx)("h3",{children:"People who liked this post"})]}),(0,l.jsx)("div",{className:u().likesModalContent,children:(null===(h=k.currentPostLikes[A])||void 0===h?void 0:null===(p=h.allLikes)||void 0===p?void 0:p.length)>0?k.currentPostLikes[A].allLikes.map(e=>(0,l.jsxs)("div",{className:u().likeUserItem,children:[(0,l.jsx)("img",{src:"".concat(m.C,"/uploads/").concat(e.profilePicture||"default.png"),alt:e.name,className:u().likeUserAvatar,onError:e=>{e.target.src="/images/default-profile.png"}}),(0,l.jsxs)("div",{className:u().likeUserInfo,children:[(0,l.jsx)("p",{className:u().likeUserName,children:e.name}),(0,l.jsx)("p",{className:u().likeUserHandle,children:X(e.name)})]})]},e._id)):(0,l.jsx)("p",{className:u().noLikesMessage,children:"No likes to display"})})]})})]})})}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[698,636,593,792],()=>s(8507)),_N_E=e.O()}]);